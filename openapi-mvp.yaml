openapi: 3.0.3
info:
  title: VibeCheck MVP - Aesthetic Social Media Companion API
  description: |
    Minimum Viable Product API specification for VibeCheck.

    This MVP focuses on the core user loop:
      1. Register & authenticate
      2. Browse content across 5 categories (cinema, music, games, books, travel)
      3. Share content to build your aesthetic profile
      4. View & customize your Aura identity

    Features deferred to post-MVP:
      - Aura matching & compatibility scoring
      - Badges, gamification & curator levels
      - Community moodboard posts (likes, comments)
      - Aesthetic rooms (join, leave, room posts)
      - Discovery feed
  version: 0.1.0
  contact:
    name: VibeCheck Support
  license:
    name: MIT

servers:
  - url: http://localhost:3000/api/v1
    description: Development server

tags:
  - name: Auth
    description: Authentication endpoints
  - name: User Profile
    description: User profile management
  - name: Content
    description: Browse content across categories
  - name: Search
    description: Global search across all content
  - name: Aura
    description: User aesthetic identity
  - name: Shares
    description: Content sharing and curation

# ──────────────────────────────────────────────
# PATHS — 17 endpoints (down from 37 in full spec)
# ──────────────────────────────────────────────
paths:

  # ── Auth ────────────────────────────────────
  /auth/login:
    post:
      tags: [Auth]
      summary: User login
      operationId: loginUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  format: password
            example:
              email: user@example.com
              password: password123
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                  user:
                    $ref: '#/components/schemas/User'
              example:
                token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
                user:
                  userId: "u_123"
                  email: user@example.com
                  username: aesthetic_anna
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '400':
          $ref: '#/components/responses/BadRequest'

  /auth/register:
    post:
      tags: [Auth]
      summary: User registration
      operationId: registerUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password, username]
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  format: password
                username:
                  type: string
                  minLength: 3
                  maxLength: 20
      responses:
        '201':
          description: Registration successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                  user:
                    $ref: '#/components/schemas/User'
        '400':
          $ref: '#/components/responses/BadRequest'
        '409':
          description: Email or username already exists

  # ── User Profile ────────────────────────────
  /users/profile:
    get:
      tags: [User Profile]
      summary: Get current user profile
      operationId: getUserProfile
      security:
        - bearerAuth: []
      responses:
        '200':
          description: User profile retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

    put:
      tags: [User Profile]
      summary: Update user profile
      operationId: updateUserProfile
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                bio:
                  type: string
                  maxLength: 500
                avatar:
                  type: string
                  format: uri
      responses:
        '200':
          description: Profile updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

  /users/{userId}:
    get:
      tags: [User Profile]
      summary: Get user profile by ID
      operationId: getUserById
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: User profile retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '404':
          $ref: '#/components/responses/NotFound'

  # ── Content: Movies ─────────────────────────
  /content/movies:
    get:
      tags: [Content]
      summary: Get all movies
      operationId: getMovies
      parameters:
        - name: search
          in: query
          schema:
            type: string
          description: Search by title or director
        - name: year
          in: query
          schema:
            type: integer
          description: Filter by year
        - name: type
          in: query
          schema:
            type: string
            enum: [movie, tv]
          description: Filter by type
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: Movies list
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/PaginatedResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Movie'
        '400':
          $ref: '#/components/responses/BadRequest'

  /content/movies/{movieId}:
    get:
      tags: [Content]
      summary: Get movie details
      operationId: getMovieById
      parameters:
        - name: movieId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Movie details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Movie'
        '404':
          $ref: '#/components/responses/NotFound'

  # ── Content: Albums ─────────────────────────
  /content/albums:
    get:
      tags: [Content]
      summary: Get all albums
      operationId: getAlbums
      parameters:
        - name: search
          in: query
          schema:
            type: string
          description: Search by title or artist
        - name: artist
          in: query
          schema:
            type: string
          description: Filter by artist
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: Albums list
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/PaginatedResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Album'
        '400':
          $ref: '#/components/responses/BadRequest'

  /content/albums/{albumId}:
    get:
      tags: [Content]
      summary: Get album details
      operationId: getAlbumById
      parameters:
        - name: albumId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Album details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Album'
        '404':
          $ref: '#/components/responses/NotFound'

  # ── Content: Games ──────────────────────────
  /content/games:
    get:
      tags: [Content]
      summary: Get all games
      operationId: getGames
      parameters:
        - name: search
          in: query
          schema:
            type: string
          description: Search by title
        - name: platform
          in: query
          schema:
            type: string
          description: Filter by platform
        - name: difficulty
          in: query
          schema:
            type: string
            enum: [Easy, Medium, Hard]
          description: Filter by difficulty
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: Games list
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/PaginatedResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Game'
        '400':
          $ref: '#/components/responses/BadRequest'

  /content/games/{gameId}:
    get:
      tags: [Content]
      summary: Get game details
      operationId: getGameById
      parameters:
        - name: gameId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Game details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Game'
        '404':
          $ref: '#/components/responses/NotFound'

  # ── Content: Books ──────────────────────────
  /content/books:
    get:
      tags: [Content]
      summary: Get all books
      operationId: getBooks
      parameters:
        - name: search
          in: query
          schema:
            type: string
          description: Search by title or author
        - name: author
          in: query
          schema:
            type: string
          description: Filter by author
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: Books list
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/PaginatedResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Book'
        '400':
          $ref: '#/components/responses/BadRequest'

  /content/books/{bookId}:
    get:
      tags: [Content]
      summary: Get book details
      operationId: getBookById
      parameters:
        - name: bookId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Book details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Book'
        '404':
          $ref: '#/components/responses/NotFound'

  # ── Content: Locations ──────────────────────
  /content/locations:
    get:
      tags: [Content]
      summary: Get all travel destinations
      operationId: getLocations
      parameters:
        - name: search
          in: query
          schema:
            type: string
          description: Search by name or city
        - name: country
          in: query
          schema:
            type: string
          description: Filter by country
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: Locations list
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/PaginatedResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Location'
        '400':
          $ref: '#/components/responses/BadRequest'

  /content/locations/{locationId}:
    get:
      tags: [Content]
      summary: Get location details
      operationId: getLocationById
      parameters:
        - name: locationId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Location details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Location'
        '404':
          $ref: '#/components/responses/NotFound'

  # ── Search ──────────────────────────────────
  /search:
    get:
      tags: [Search]
      summary: Global search across all content
      operationId: globalSearch
      parameters:
        - name: query
          in: query
          required: true
          schema:
            type: string
          description: Search query
        - $ref: '#/components/parameters/Categories'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    description: Mixed content objects matching the search query
                    items:
                      oneOf:
                        - $ref: '#/components/schemas/Movie'
                        - $ref: '#/components/schemas/Album'
                        - $ref: '#/components/schemas/Game'
                        - $ref: '#/components/schemas/Book'
                        - $ref: '#/components/schemas/Location'
        '400':
          $ref: '#/components/responses/BadRequest'

  # ── Aura Profile ────────────────────────────
  /aura/profile:
    get:
      tags: [Aura]
      summary: Get current user's aura profile
      operationId: getCurrentUserAura
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Aura profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuraProfile'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

    put:
      tags: [Aura]
      summary: Update aura profile
      operationId: updateAuraProfile
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                aestheticTags:
                  type: array
                  items:
                    type: string
                auraColors:
                  type: array
                  items:
                    type: string
                    pattern: '^#[0-9A-Fa-f]{6}$'
      responses:
        '200':
          description: Aura profile updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuraProfile'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

  /aura/profile/{userId}:
    get:
      tags: [Aura]
      summary: Get user's aura profile
      operationId: getUserAura
      parameters:
        - name: userId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Aura profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuraProfile'
        '404':
          $ref: '#/components/responses/NotFound'

  # ── Shares ──────────────────────────────────
  /aura/shares:
    get:
      tags: [Shares]
      summary: Get current user's shares
      operationId: getUserShares
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: User shares list
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/PaginatedResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/UserShare'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

    post:
      tags: [Shares]
      summary: Create a new share
      operationId: createShare
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [category, contentId]
              properties:
                category:
                  type: string
                  enum: [cinema, music, games, books, travel]
                contentId:
                  type: string
                caption:
                  type: string
                  maxLength: 500
      responses:
        '201':
          description: Share created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserShare'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

# ──────────────────────────────────────────────
# COMPONENTS
# ──────────────────────────────────────────────
components:

  schemas:
    # ── Core entities ─────────────────────────
    User:
      type: object
      required: [userId, email, username]
      properties:
        userId:
          type: string
        email:
          type: string
          format: email
        username:
          type: string
        avatar:
          type: string
          format: uri
        bio:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    # ── Content schemas ───────────────────────
    Movie:
      type: object
      required: [id, title, year, director, type]
      properties:
        id:
          type: string
        title:
          type: string
        year:
          type: integer
        director:
          type: string
        poster:
          type: string
          format: uri
        season:
          type: integer
        episode:
          type: integer
        type:
          type: string
          enum: [movie, tv]
        url:
          type: string
          format: uri

    Album:
      type: object
      required: [id, title, artist]
      properties:
        id:
          type: string
        title:
          type: string
        artist:
          type: string
        cover:
          type: string
          format: uri
        duration:
          type: integer
          description: Duration in seconds
        url:
          type: string
          format: uri

    Game:
      type: object
      required: [id, title, platform]
      properties:
        id:
          type: string
        title:
          type: string
        platform:
          type: string
        cover:
          type: string
          format: uri
        difficulty:
          type: string
          enum: [Easy, Medium, Hard]
        url:
          type: string
          format: uri

    Book:
      type: object
      required: [id, title, author]
      properties:
        id:
          type: string
        title:
          type: string
        author:
          type: string
        cover:
          type: string
          format: uri
        totalPages:
          type: integer
        url:
          type: string
          format: uri

    Location:
      type: object
      required: [id, name, city, country]
      properties:
        id:
          type: string
        name:
          type: string
        city:
          type: string
        country:
          type: string
        image:
          type: string
          format: uri
        weather:
          type: string
        temperature:
          type: number
          format: float
        timezone:
          type: string
        url:
          type: string
          format: uri

    # ── Aura & Shares ─────────────────────────
    UserShare:
      type: object
      required: [id, category, title]
      properties:
        id:
          type: string
        userId:
          type: string
        category:
          type: string
          enum: [cinema, music, games, books, travel]
        title:
          type: string
        image:
          type: string
          format: uri
        dominantColor:
          type: string
          pattern: '^#[0-9A-Fa-f]{6}$'
        caption:
          type: string
        timestamp:
          type: string
          format: date-time

    AuraProfile:
      type: object
      required: [userId, username]
      properties:
        userId:
          type: string
        username:
          type: string
        avatar:
          type: string
          format: uri
        bio:
          type: string
        recentShares:
          type: array
          description: User's recent content shares across all categories
          items:
            $ref: '#/components/schemas/UserShare'
        auraColors:
          type: array
          description: "Hex color codes (#RRGGBB) representing user's aesthetic aura"
          items:
            type: string
            pattern: '^#[0-9A-Fa-f]{6}$'
            example: '#FF6B9D'
        aestheticTags:
          type: array
          description: Aesthetic style tags (e.g., minimalist, vintage, dark academia)
          items:
            type: string
            example: minimalist
        topCategories:
          type: array
          description: Content distribution across categories with percentage breakdown
          items:
            type: object
            properties:
              category:
                type: string
                description: Content category (cinema, music, games, books, travel)
              percentage:
                type: number
                minimum: 0
                maximum: 100
                description: Percentage of user's content in this category

    # ── Shared helpers ────────────────────────
    PaginatedResponse:
      type: object
      properties:
        total:
          type: integer
          description: Total number of items matching the query
        limit:
          type: integer
          description: Maximum items returned per request
        offset:
          type: integer
          description: Pagination offset value

  # ── Parameters ──────────────────────────────
  parameters:
    Limit:
      name: limit
      in: query
      description: Maximum number of items to return
      schema:
        type: integer
        default: 20
    Offset:
      name: offset
      in: query
      description: Pagination offset
      schema:
        type: integer
        default: 0
    Categories:
      name: categories
      in: query
      description: "Filter by categories (CSV list: cinema,music,games,books,travel)"
      style: form
      explode: false
      schema:
        type: array
        items:
          type: string
          enum: [cinema, music, games, books, travel]

  # ── Responses ───────────────────────────────
  responses:
    BadRequest:
      description: Bad request - invalid parameters
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
              message:
                type: string

    UnauthorizedError:
      description: Authentication required
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
              message:
                type: string

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
              message:
                type: string

    ServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
              message:
                type: string

  # ── Security ────────────────────────────────
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
